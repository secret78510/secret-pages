(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-0087690d"],{"08e7":function(t,s,a){"use strict";a.r(s);var i=function(){var t=this,s=t._self._c;return s("div",{staticClass:"wrap"},[t.isLoading?s("div",{staticClass:"loading"},[s("div",{staticClass:"loading-item fas fas fa-apple-alt"}),s("div",{staticClass:"loading-item fas fa-lemon"}),s("div",{staticClass:"loading-item fas fa-carrot"})]):t._e(),t._m(0),t._m(1),s("section",[s("div",{staticClass:"container"},[s("div",{staticClass:"row"},[s("div",{staticClass:"col-md-3 my-2"},[s("div",{staticClass:"Sidebar-sticky"},[s("h5",{staticClass:"text-info"},[t._v("商品分類")]),s("ul",{staticClass:"Sidebar-menu"},[s("li",[s("a",{attrs:{href:"#"},on:{click:function(s){s.preventDefault(),t.category="all"}}},[t._v("全部商品")])]),s("li",[s("a",{attrs:{href:"#"},on:{click:function(s){s.preventDefault(),t.category="蔬菜"}}},[t._v("蔬菜")])]),s("li",[s("a",{attrs:{href:"#"},on:{click:function(s){s.preventDefault(),t.category="水果"}}},[t._v("水果")])]),s("li",[s("a",{attrs:{href:"#"},on:{click:function(s){s.preventDefault(),t.category="我的最愛"}}},[t._v("我的最愛")])])])])]),s("div",{staticClass:"col-md-9"},[s("div",{staticClass:"row",staticStyle:{overflow:"hidden"}},t._l(t.filteredTodo,(function(a){return s("div",{key:a.id,staticClass:"col-md-6 my-4 card-Hover",on:{click:function(s){return t.getProduct(a.id)}}},[s("div",{staticClass:"card border-0 shadow-sm"},[s("div",{staticStyle:{height:"200px","background-size":"cover","background-position":"center"},style:{backgroundImage:`url(${a.image})`}}),s("div",{staticClass:"card-body px-3 pb-1"},[s("div",{staticClass:"clearfix"},[s("button",{staticClass:"fa-star btn-icon float-left",class:{fas:a.isStar,far:!t.starProduct.id},attrs:{title:"加入最愛"},on:{click:function(s){return s.stopPropagation(),t.addStar(a)}}}),a.price?s("del",{staticClass:"h6 float-right"},[t._v(" "+t._s(t._f("currency")(a.origin_price)))]):t._e()]),s("div",{staticClass:"clearfix"},[s("span",{staticClass:"badge badge-success float",staticStyle:{color:"#1b1a1b"}},[t._v(" "+t._s(a.category))]),a.price?t._e():s("div",{staticClass:"h5 float-right"},[t._v(" "+t._s(t._f("currency")(a.origin_price)))]),a.price?s("div",{staticClass:"h5 float-right"},[t._v(" "+t._s(t._f("currency")(a.price)))]):t._e()])]),s("div",{staticClass:"px-3 pb-1"},[s("h4",[t._v(t._s(a.title))]),s("p",[t._v(t._s(a.description))])]),s("div",{staticClass:"card-footer d-flex"},[s("button",{staticClass:"btn btn-outline-primary btn-sm",attrs:{type:"button"},on:{click:function(s){return s.stopPropagation(),t.getProduct(a.id)}}},[t.status.loadingGetProduct===a.id?s("i",{staticClass:"fas fa-spinner fa-spin"}):t._e(),t._v(" 查看更多 ")]),s("button",{staticClass:"btn btn-outline-danger btn-sm ml-auto",attrs:{type:"button"},on:{click:function(s){return s.stopPropagation(),t.addCart(a.id)}}},[t.status.loadingAddCart===a.id?s("i",{staticClass:"fas fa-spinner fa-spin"}):t._e(),t._v(" 加到購物車 ")])])])])})),0)])])])]),s("a",{staticClass:"iconBottom",attrs:{href:"#",title:"結帳去"},on:{click:function(s){return s.preventDefault(),t.toShoppingCart()}}},[s("i",{staticClass:"fas fa-shopping-cart"}),t.cart.carts.length>=1?s("small",{staticClass:"text-danger"},[t._v(t._s(t.cart.carts.length))]):t._e()])])},r=[function(){var t=this,s=t._self._c;return s("div",{staticClass:"marquee bg-success"},[s("i",{staticClass:"far fa-bell"}),s("span",[t._v("點擊星星即可加入最愛，編輯喜愛的商品。")])])},function(){var t=this,s=t._self._c;return s("section",[s("div",{staticClass:"img"},[s("h2",[t._v("產品列表")])])])}],e=(a("14d9"),{data(){return{isLoading:!1,products:[],status:{loadingAddCart:"",loadingGetProduct:""},category:"all",starProduct:[]}},computed:{filteredTodo(){const t={};switch(this.category){case"all":return this.products;case"蔬菜":for(let s=0;s<this.products.length;s+=1)"蔬菜"===this.products[s].category&&(t[s]=this.products[s]);return t;case"水果":for(let s=0;s<this.products.length;s+=1)"水果"===this.products[s].category&&(t[s]=this.products[s]);return t;case"我的最愛":return this.starProduct;default:return this.products}},cart(){return this.$store.state.cart}},methods:{getProducts(){const t="https://vue-course-api.hexschool.io/api/secret78510/products/all";this.isLoading=!0,this.axios.get(t).then(t=>{this.isLoading=!1,this.products=t.data.products;const s=sessionStorage.getItem("category");s&&(this.category=s);for(let a=0;a<this.products.length;a+=1)this.products[a].isStar=!1;this.myFavourite()})},myFavourite(){const t=JSON.parse(localStorage.getItem("Star"));t&&(this.starProduct=t,this.products.forEach(t=>{const s=t;this.starProduct.forEach(t=>{t.id===s.id&&(s.isStar=!0)})}))},getProduct(t){const s="https://vue-course-api.hexschool.io/api/secret78510/product/"+t;this.status.loadingGetProduct=t,this.$http.get(s).then(()=>{this.status.loadingGetProduct="",localStorage.setItem("product",JSON.stringify(t)),this.$router.push("/introduction")})},addCart(t,s=1){const a="https://vue-course-api.hexschool.io/api/secret78510/cart";this.isLoading=!0,this.status.loadingAddCart=t;const i={product_id:t,qty:s};this.$http.post(a,{data:i}).then(()=>{this.$store.dispatch("getCart"),this.status.loadingAddCart="",this.isLoading=!1})},addStar(t){const s=t,a=this.starProduct.some(t=>t.id===s.id);this.starProduct.includes(s)||a?(s.isStar=!1,this.starProduct.splice(this.starProduct.indexOf(s),1),this.products.forEach(t=>{const a=t;a.id===s.id&&(a.isStar=!1)})):(s.isStar=!0,this.starProduct.push(s)),localStorage.setItem("Star",JSON.stringify(this.starProduct)),this.myFavourite()},toShoppingCart(){this.$store.dispatch("getCart"),this.cart.carts.length>=1&&"/shopping_cart"!==this.$router.history.current.path?this.$router.push("/shopping_cart"):"/product_list"!==this.$router.history.current.path&&"/shopping_cart"!==this.$router.history.current.path&&(this.$router.push("/product_list"),this.$bus.$emit("message:push","購物車內無商品，請選購。")),this.cart.carts.length||this.$bus.$emit("message:push","購物車內無商品，請選購。")},removeSessionStorage(){sessionStorage.removeItem("category")}},created(){this.getProducts(),this.$store.dispatch("getCart")},mounted(){window.addEventListener("unload",this.removeSessionStorage)},Destroy(){window.removeEventListener("unload",this.removeSessionStorage)}}),o=e,c=(a("5580"),a("2877")),n=Object(c["a"])(o,i,r,!1,null,"602b772e",null);s["default"]=n.exports},5580:function(t,s,a){"use strict";a("8570")},8570:function(t,s,a){}}]);
//# sourceMappingURL=chunk-0087690d.60c2afd1.js.map