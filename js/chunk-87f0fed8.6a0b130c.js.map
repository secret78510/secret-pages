{"version":3,"sources":["webpack:///./src/views/frontend/ShoppingCart.vue?3f3e","webpack:///./src/views/frontend/ShoppingCart.vue","webpack:///src/views/frontend/ShoppingCart.vue","webpack:///./src/views/frontend/ShoppingCart.vue?6797","webpack:///./src/views/frontend/ShoppingCart.vue?7d0d"],"names":["render","_vm","this","_c","_self","staticClass","isLoading","_e","_m","_l","cart","carts","item","key","id","_v","_s","product","title","on","finalTotal","qty","unit","_f","price","origin_price","attrs","$event","removeCart","product_id","length","staticStyle","total","final_total","preventDefault","addCoupon","apply","arguments","directives","name","rawName","value","couponCode","expression","domProps","target","composing","error","addCart","staticRenderFns","data","productNum","delCart","origin_carts","methods","returnShop","api","$http","get","then","getCart","$bus","$emit","$router","push","filter","vm","aa","map","delete","Promise","allSettled","useAllCoupon","coupons","coupon","code","post","response","success","_response$data$data$c","_response$data","newCart","JSON","parse","stringify","cartsMap","Map","forEach","set","mapItem","MapItem","splice","delApi","_vm$cart$carts","some","_vm$cart$carts$find","couponApi","find","_item$coupon$percent","_item$coupon","percent","created","beforeUpdate","component"],"mappings":"kHAAA,W,2CCAA,IAAIA,EAAS,WAAkB,IAAIC,EAAIC,KAAKC,EAAGF,EAAIG,MAAMD,GAAG,OAAOA,EAAG,MAAM,CAACE,YAAY,QAAQ,CAAEJ,EAAIK,UAAWH,EAAG,MAAM,CAACE,YAAY,WAAW,CAACF,EAAG,MAAM,CAACE,YAAY,sCAAsCF,EAAG,MAAM,CAACE,YAAY,8BAA8BF,EAAG,MAAM,CAACE,YAAY,iCAAiCJ,EAAIM,KAAKN,EAAIO,GAAG,GAAGL,EAAG,UAAU,CAACA,EAAG,MAAM,CAACE,YAAY,aAAa,CAACJ,EAAIO,GAAG,GAAGL,EAAG,QAAQ,CAACE,YAAY,qBAAqB,CAACJ,EAAIO,GAAG,GAAGL,EAAG,QAAQF,EAAIQ,GAAIR,EAAIS,KAAKC,OAAO,SAASC,GAAM,OAAOT,EAAG,KAAK,CAACU,IAAID,EAAKE,IAAI,CAACX,EAAG,KAAK,CAACE,YAAY,gBAAgB,CAACJ,EAAIc,GAAG,IAAId,EAAIe,GAAGJ,EAAKK,QAAQC,OAAO,OAAOf,EAAG,KAAK,CAACE,YAAY,mBAAmBc,GAAG,CAAC,OAASlB,EAAImB,aAAa,CAACnB,EAAIc,GAAG,IAAId,EAAIe,GAAGJ,EAAKS,KAAK,IAAIpB,EAAIe,GAAGJ,EAAKK,QAAQK,MAAM,OAAOnB,EAAG,KAAK,CAACE,YAAY,+BAA+B,CAACJ,EAAIc,GAAGd,EAAIe,GAAGf,EAAIsB,GAAG,WAAPtB,CAAmBW,EAAKK,QAAQO,WAAWrB,EAAG,KAAK,CAACE,YAAY,gBAAgB,CAACJ,EAAIc,GAAG,IAAId,EAAIe,GAAGf,EAAIsB,GAAG,WAAPtB,CAAmBW,EAAKS,KAAOT,EAAKK,QAAQO,MAAQZ,EAAKK,QAAQO,MAAQZ,EAAKK,QAAQQ,gBAAgB,OAAOtB,EAAG,KAAK,CAACE,YAAY,gBAAgB,CAACF,EAAG,SAAS,CAACE,YAAY,gCAAgCqB,MAAM,CAAC,KAAO,UAAUP,GAAG,CAAC,MAAQ,SAASQ,GAAQ,OAAO1B,EAAI2B,WAAWhB,EAAKiB,eAAe,CAAC1B,EAAG,IAAI,CAACE,YAAY,8BAA6B,KAAKF,EAAG,MAAM,CAACE,YAAY,QAAQ,CAAEJ,EAAIS,KAAKC,MAAOR,EAAG,IAAI,CAACE,YAAY,cAAc,CAACF,EAAG,OAAO,CAACF,EAAIc,GAAG,SAASZ,EAAG,IAAI,CAACF,EAAIc,GAAGd,EAAIe,GAAGf,EAAIS,KAAKC,MAAMmB,WAAW3B,EAAG,OAAO,CAACF,EAAIc,GAAG,WAAWd,EAAIM,KAAKJ,EAAG,IAAI,CAACE,YAAY,aAAa0B,YAAY,CAAC,YAAY,SAAS,CAAC9B,EAAIc,GAAG,MAAMd,EAAIe,GAAGf,EAAIsB,GAAG,WAAPtB,CAAmBA,EAAI+B,WAAY/B,EAAIS,KAAKuB,cAAgBhC,EAAIS,KAAKsB,MAAO7B,EAAG,IAAI,CAACE,YAAY,aAAa0B,YAAY,CAAC,YAAY,SAAS,CAAC9B,EAAIc,GAAG,OAAOd,EAAIe,GAAGf,EAAIsB,GAAG,WAAPtB,CAAmBA,EAAIgC,iBAAiBhC,EAAIM,KAAKJ,EAAG,IAAI,CAACE,YAAY,gCAAgC,CAACJ,EAAIc,GAAG,gBAAgBZ,EAAG,MAAM,CAACE,YAAY,iBAAiB,CAACF,EAAG,SAAS,CAACE,YAAY,kEAAkE0B,YAAY,CAAC,OAAS,QAAQL,MAAM,CAAC,KAAO,UAAUP,GAAG,CAAC,MAAQ,SAASQ,GAAgC,OAAxBA,EAAOO,iBAAwBjC,EAAIkC,UAAUC,MAAM,KAAMC,cAAc,CAACpC,EAAIc,GAAG,WAAWZ,EAAG,QAAQ,CAACmC,WAAW,CAAC,CAACC,KAAK,QAAQC,QAAQ,UAAUC,MAAOxC,EAAIyC,WAAYC,WAAW,eAAetC,YAAY,wBAAwB0B,YAAY,CAAC,OAAS,QAAQL,MAAM,CAAC,KAAO,OAAO,MAAQ,MAAM,YAAc,UAAUkB,SAAS,CAAC,MAAS3C,EAAIyC,YAAavB,GAAG,CAAC,MAAQ,SAASQ,GAAWA,EAAOkB,OAAOC,YAAiB7C,EAAIyC,WAAWf,EAAOkB,OAAOJ,aAAYtC,EAAG,MAAM,CAACE,YAAY,YAAY,CAAEJ,EAAI8C,MAAMjB,OAAS,EAAG3B,EAAG,IAAI,CAACE,YAAY,mCAAmC0B,YAAY,CAAC,eAAe,UAAU,CAAC9B,EAAIc,GAAGd,EAAIe,GAAGd,KAAK6C,UAAU9C,EAAIM,OAAOJ,EAAG,MAAM,CAACE,YAAY,YAAY,CAACF,EAAG,IAAI,CAACE,YAAY,gDAAgD0B,YAAY,CAAC,aAAa,QAAQL,MAAM,CAAC,KAAO,IAAI,KAAO,UAAUP,GAAG,CAAC,MAAQlB,EAAI+C,UAAU,CAAC/C,EAAIc,GAAG,oBAE/1FkC,EAAkB,CAAC,WAAY,IAAIhD,EAAIC,KAAKC,EAAGF,EAAIG,MAAMD,GAAG,OAAOA,EAAG,UAAU,CAACA,EAAG,MAAM,CAACE,YAAY,OAAO,CAACF,EAAG,KAAK,CAACF,EAAIc,GAAG,cACjI,WAAY,IAAId,EAAIC,KAAKC,EAAGF,EAAIG,MAAMD,GAAG,OAAOA,EAAG,MAAM,CAACE,YAAY,iBAAiB,CAACF,EAAG,KAAK,CAACE,YAAY,gEAAgE,CAACJ,EAAIc,GAAG,UAAUZ,EAAG,KAAK,CAACE,YAAY,oBAAoB,CAACF,EAAG,KAAK,CAACF,EAAIc,GAAG,OAAOZ,EAAG,KAAK,CAACF,EAAIc,GAAG,QAAQZ,EAAG,KAAK,CAACF,EAAIc,GAAG,QAAQZ,EAAG,KAAK,CAACF,EAAIc,GAAG,QAAQZ,EAAG,KAAK,CAACF,EAAIc,GAAG,cACxV,WAAY,IAAId,EAAIC,KAAKC,EAAGF,EAAIG,MAAMD,GAAG,OAAOA,EAAG,QAAQ,CAACA,EAAG,KAAK,CAACF,EAAIc,GAAG,QAAQZ,EAAG,KAAK,CAACF,EAAIc,GAAG,QAAQZ,EAAG,KAAK,CAACE,YAAY,kBAAkB,CAACJ,EAAIc,GAAG,QAAQZ,EAAG,KAAK,CAACF,EAAIc,GAAG,QAAQZ,EAAG,UCyGjL,G,UAAA,CACf+C,OACA,OACAR,WAAA,GACApC,WAAA,EACAyC,MAAA,GACAI,WAAA,EACAnB,MAAA,EACAtB,KAAA,GACAuB,YAAA,EACAmB,QAAA,GACAC,aAAA,KAGAC,QAAA,CACAC,aACA,MAAAC,EAAA,2DACA,KAAAC,MAAAC,IAAAF,GAAAG,KAAA,KACA,SAAAjD,KAAAC,MAAAmB,SACA,KAAA8B,UACA,KAAAC,KAAAC,MAAA,+BACA,KAAAC,QAAAC,KAAA,qBAIApC,WAAAd,GACA,MAAAH,EAAA,KAAA0C,aAAAY,OAAArD,KAAAiB,aAAAf,GACAoD,EAAA,KACAA,EAAA5D,WAAA,EACA,MAAA6D,EAAAxD,EAAAyD,IAAA,UACA,MAAAZ,EAAA,gDAAA5C,EAAAE,SACAoD,EAAAT,MAAAY,OAAAb,GAAAG,KAAA,UAEAW,QAAAC,WAAA,IAAAJ,IAAAR,KAAA,KACAO,EAAA5D,WAAA,EACA4D,EAAAN,UACAM,EAAAX,gBAGAiB,aAAA7D,GACA,MAAA8D,EAAA9D,EAAAsD,OAAArD,KAAA8D,QACAlB,EAAA,8DACA,KAAAmB,GAAAF,EAAA,GAAAC,OACA,KAAAjB,MAAAmB,KAAApB,EAAA,CAAAN,KAAA,CAAAyB,UAAAhB,KAAAkB,IACAA,EAAA3B,KAAA4B,SACA,KAAAlB,aAIAzB,YACA,MAAAqB,EAAA,6DACAkB,EAAA,CACAC,KAAA,KAAAjC,YAEA,KAAApC,WAAA,EACA,KAAAmD,MAAAmB,KAAApB,EAAA,CAAAN,KAAAwB,IAAAf,KAAAkB,IACAA,EAAA3B,KAAA4B,SACA,KAAAlB,UACA,KAAAtD,WAAA,EACA,KAAAyC,MAAA,KAEA,KAAAzC,WAAA,EACA,KAAAyC,MAAA,gBAIAa,UACA,MAAAJ,EAAA,2DACA,KAAAlD,WAAA,EACA,KAAAmD,MAAAC,IAAAF,GAAAG,KAAAkB,IAAA,IAAAE,EAAAC,EACA,MAAAP,EAAA,QAAAM,EAAAF,EAAA3B,UAAAvC,aAAA,IAAAoE,OAAA,EAAAA,EAAAd,OAAArD,KAAA8D,QACA,UAAAD,QAAA,IAAAA,KAAA3C,QAAA2C,EAAA3C,QAAA,QAAAkD,EAAAH,EAAA3B,YAAA,IAAA8B,GAAA,QAAAA,IAAA9B,YAAA,IAAA8B,GAAA,QAAAA,IAAArE,aAAA,IAAAqE,OAAA,EAAAA,EAAAlD,QACA,KAAA0C,aAAAK,EAAA3B,UAAAvC,WACA,CACA,KAAA0C,aAAA,IAAAwB,EAAA3B,UAAAvC,OACA,KAAAD,KAAAmE,EAAA3B,UACA,MAAA+B,EAAAC,KAAAC,MAAAD,KAAAE,UAAA,KAAA1E,OACA2E,EAAA,IAAAC,IACAL,EAAAtE,MAAA4E,QAAA3E,IACAyE,EAAAG,IAAA5E,EAAAK,QAAAH,GAAAF,KAEAyE,EAAAE,QAAAE,IACA,MAAAC,EAAAD,EACAC,EAAArE,IAAA,EACAqE,EAAAzD,YAAA,EACAyD,EAAA1D,MAAA,IAEAqD,EAAAE,QAAAE,IACA,MAAAC,EAAAD,EACA,KAAA/E,KAAAC,MAAA4E,QAAA3E,IACAA,EAAAiB,aAAA6D,EAAA7D,aACA6D,EAAArE,KAAAT,EAAAS,IACAqE,EAAAzD,YAAArB,EAAAqB,YACAyD,EAAA1D,MAAApB,EAAAoB,WAIA,KAAAtB,KAAAC,MAAAgF,OAAA,OAAAjF,KAAAC,MAAAmB,QACAuD,EAAAE,QAAAnB,GAAA,KAAA1D,KAAAC,MAAAqD,KAAAI,IACA,KAAA9D,WAAA,MAIA0C,UACA,MAAAQ,EAAA,2DACA,IAAAoC,EAAA,GACAlF,EAAA,GACA,MAAAwD,EAAA,MACA,eAAA2B,GAeA,SAdA3B,EAAAT,MAAAC,IAAAF,GAAAG,KAAAkB,IACAX,EAAAd,QAAAyB,EAAA3B,kBAEAgB,EAAAd,QAAAzC,MAAA4E,QAAA,UACAK,EAAA,4DAAAhF,EAAAE,SACAoD,EAAAT,MAAAY,OAAAuB,GAAAjC,KAAA,gBAEAO,EAAAxD,KAAAC,MAAA4E,QAAA,UACA7E,EAAA,CACAmB,WAAAjB,EAAAK,QAAAH,GACAO,IAAAT,EAAAS,WAEA6C,EAAAT,MAAAmB,KAAApB,EAAA,CAAAN,KAAAxC,IAAAiD,KAAA,UAEA,QAAAkC,EAAA3B,EAAAxD,KAAAC,aAAA,IAAAkF,KAAA/D,QAAAoC,EAAAxD,KAAAC,MAAAmF,KAAAlF,GAAA,OAAAA,QAAA,IAAAA,OAAA,EAAAA,EAAA8D,QAAA,KAAAqB,EACA,MAAAC,EAAA,6DACArB,EAAA,QAAAoB,EAAA7B,EAAAxD,KAAAC,MAAAsF,KAAArF,GAAA,OAAAA,QAAA,IAAAA,OAAA,EAAAA,EAAA8D,eAAA,IAAAqB,GAAA,QAAAA,IAAArB,cAAA,IAAAqB,OAAA,EAAAA,EAAApB,WACAT,EAAAT,MAAAmB,KAAAoB,EAAA,CAAA9C,KAAA,CAAAyB,UAAAhB,KAAA,QAEAO,EAAAH,QAAAC,KAAA,WApBA,IAuBA5C,aACA,KAAAY,MAAA,EACA,KAAAC,YAAA,EACA,KAAAvB,KAAAC,MAAA4E,QAAA3E,IAAA,IAAAsF,EAAAC,EACA,MAAA3E,EAAAZ,EAAAK,QAAAO,MAAAZ,EAAAK,QAAAO,MAAAZ,EAAAK,QAAAQ,aACAiD,EAAA,QAAAwB,EAAA,OAAAtF,QAAA,IAAAA,GAAA,QAAAuF,EAAAvF,EAAA8D,cAAA,IAAAyB,OAAA,EAAAA,EAAAC,eAAA,IAAAF,IAAA,IACA,KAAAlE,OAAApB,EAAAS,IAAAG,EACA,KAAAS,aAAArB,EAAAS,IAAAG,EAAAkD,EAAA,QAIA2B,UACA,KAAAzC,WAEA0C,eACA,KAAAlF,gBC/PoW,I,wBCQhWmF,EAAY,eACd,EACAvG,EACAiD,GACA,EACA,KACA,WACA,MAIa,aAAAsD,E","file":"js/chunk-87f0fed8.6a0b130c.js","sourcesContent":["export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ShoppingCart.vue?vue&type=style&index=0&id=41fde6e7&prod&lang=scss&scoped=true\"","var render = function render(){var _vm=this,_c=_vm._self._c;return _c('div',{staticClass:\"wrap\"},[(_vm.isLoading)?_c('div',{staticClass:\"loading\"},[_c('div',{staticClass:\"loading-item fas fas fa-apple-alt\"}),_c('div',{staticClass:\"loading-item fas fa-lemon\"}),_c('div',{staticClass:\"loading-item fas fa-carrot\"})]):_vm._e(),_vm._m(0),_c('section',[_c('div',{staticClass:\"container\"},[_vm._m(1),_c('table',{staticClass:\"table text-center\"},[_vm._m(2),_c('tbody',_vm._l((_vm.cart.carts),function(item){return _c('tr',{key:item.id},[_c('td',{staticClass:\"align-middle\"},[_vm._v(\" \"+_vm._s(item.product.title)+\" \")]),_c('td',{staticClass:\"align-middle p-0\",on:{\"change\":_vm.finalTotal}},[_vm._v(\" \"+_vm._s(item.qty)+\" \"+_vm._s(item.product.unit)+\" \")]),_c('td',{staticClass:\"align-middle smallPhoneHide\"},[_vm._v(_vm._s(_vm._f(\"currency\")(item.product.price)))]),_c('td',{staticClass:\"align-middle\"},[_vm._v(\" \"+_vm._s(_vm._f(\"currency\")(item.qty * (item.product.price ? item.product.price : item.product.origin_price)))+\" \")]),_c('td',{staticClass:\"align-middle\"},[_c('button',{staticClass:\"btn btn-outline-danger btn-sm\",attrs:{\"type\":\"button\"},on:{\"click\":function($event){return _vm.removeCart(item.product_id)}}},[_c('i',{staticClass:\"far fa-trash-alt\"})])])])}),0)]),_c('div',{staticClass:\"cart\"},[(_vm.cart.carts)?_c('p',{staticClass:\"text-right\"},[_c('span',[_vm._v(\"總計共\")]),_c('b',[_vm._v(_vm._s(_vm.cart.carts.length))]),_c('span',[_vm._v(\"種商品\")])]):_vm._e(),_c('p',{staticClass:\"text-right\",staticStyle:{\"font-size\":\"22px\"}},[_vm._v(\"總計:\"+_vm._s(_vm._f(\"currency\")(_vm.total)))]),(_vm.cart.final_total !== _vm.cart.total)?_c('p',{staticClass:\"text-right\",staticStyle:{\"font-size\":\"22px\"}},[_vm._v(\"折扣價:\"+_vm._s(_vm._f(\"currency\")(_vm.final_total)))]):_vm._e(),_c('p',{staticClass:\"text-right text-primary py-2\"},[_vm._v(\"(免運費)信用卡付款\")]),_c('div',{staticClass:\"clearfix py-2\"},[_c('button',{staticClass:\"btn btn-outline-primary btn-sm float-right rounded-0 btn-custom\",staticStyle:{\"height\":\"28px\"},attrs:{\"type\":\"button\"},on:{\"click\":function($event){$event.preventDefault();return _vm.addCoupon.apply(null, arguments)}}},[_vm._v(\"套用優惠碼\")]),_c('input',{directives:[{name:\"model\",rawName:\"v-model\",value:(_vm.couponCode),expression:\"couponCode\"}],staticClass:\"float-right rounded-0\",staticStyle:{\"height\":\"28px\"},attrs:{\"type\":\"text\",\"width\":\"40%\",\"placeholder\":\"請輸入優惠碼\"},domProps:{\"value\":(_vm.couponCode)},on:{\"input\":function($event){if($event.target.composing)return;_vm.couponCode=$event.target.value}}})]),_c('div',{staticClass:\"clearfix\"},[(_vm.error.length > 1)?_c('p',{staticClass:\"text-danger float-right clearfix\",staticStyle:{\"margin-right\":\"132px\"}},[_vm._v(_vm._s(this.error))]):_vm._e()]),_c('div',{staticClass:\"clearfix\"},[_c('a',{staticClass:\"btn btn-primary btn-lg float-right text-white\",staticStyle:{\"margin-top\":\"10px\"},attrs:{\"href\":\"#\",\"type\":\"button\"},on:{\"click\":_vm.addCart}},[_vm._v(\"結帳去\")])])])])])])\n}\nvar staticRenderFns = [function (){var _vm=this,_c=_vm._self._c;return _c('section',[_c('div',{staticClass:\"img\"},[_c('h2',[_vm._v(\"購物車\")])])])\n},function (){var _vm=this,_c=_vm._self._c;return _c('div',{staticClass:\"progress-wrap\"},[_c('h4',{staticClass:\"text-center text-primary pt-5 font-weight-bold progressTitle\"},[_vm._v(\"結帳進度\")]),_c('ul',{staticClass:\"progressBar py-5\"},[_c('li',[_vm._v(\"0\")]),_c('li',[_vm._v(\"25\")]),_c('li',[_vm._v(\"50\")]),_c('li',[_vm._v(\"75\")]),_c('li',[_vm._v(\"100\")])])])\n},function (){var _vm=this,_c=_vm._self._c;return _c('thead',[_c('th',[_vm._v(\"品名\")]),_c('th',[_vm._v(\"數量\")]),_c('th',{staticClass:\"smallPhoneHide\"},[_vm._v(\"單價\")]),_c('th',[_vm._v(\"小計\")]),_c('th')])\n}]\n\nexport { render, staticRenderFns }","<template>\n  <div class=\"wrap\">\n    <div v-if=\"isLoading\" class=\"loading\">\n      <div class=\"loading-item fas fas fa-apple-alt\"></div>\n      <div class=\"loading-item fas fa-lemon\"></div>\n      <div class=\"loading-item fas fa-carrot\"></div>\n    </div>\n    <section>\n      <div class=\"img\">\n        <h2>購物車</h2>\n      </div>\n    </section>\n    <section>\n      <div class=\"container\">\n        <div class=\"progress-wrap\">\n          <h4 class=\"text-center text-primary pt-5 font-weight-bold progressTitle\">結帳進度</h4>\n          <ul class=\"progressBar py-5\">\n            <li>0</li>\n            <li>25</li>\n            <li>50</li>\n            <li>75</li>\n            <li>100</li>\n          </ul>\n        </div>\n        <table class=\"table text-center\">\n          <thead>\n            <th>品名</th>\n            <th>數量</th>\n            <th class=\"smallPhoneHide\">單價</th>\n            <th>小計</th>\n            <th></th>\n          </thead>\n          <tbody>\n            <tr v-for=\"item in cart.carts\" :key=\"item.id\">\n              <td class=\"align-middle\">\n                {{ item.product.title }}\n              </td>\n              <td class=\"align-middle p-0\" @change=\"finalTotal\">\n                {{ item.qty }} {{ item.product.unit }}\n              </td>\n              <td class=\"align-middle smallPhoneHide\">{{ item.product.price | currency }}</td>\n              <td class=\"align-middle\">\n                {{ item.qty * (item.product.price ? item.product.price : item.product.origin_price)\n                 | currency }}\n              </td>\n              <td class=\"align-middle\">\n                <button\n                  type=\"button\"\n                  class=\"btn btn-outline-danger btn-sm\"\n                  @click=\"removeCart(item.product_id)\"\n                >\n                  <i class=\"far fa-trash-alt\"></i>\n                </button>\n              </td>\n            </tr>\n          </tbody>\n        </table>\n        <div class=\"cart\">\n          <p class=\"text-right\" v-if=\"cart.carts\">\n            <span>總計共</span>\n            <b>{{ cart.carts.length }}</b>\n            <span>種商品</span>\n          </p>\n          <p class=\"text-right\" style=\"font-size:22px\">總計:{{ total | currency }}</p>\n          <p\n            class=\"text-right\"\n            style=\"font-size:22px\"\n            v-if=\"cart.final_total !== cart.total\"\n          >折扣價:{{ final_total | currency }}</p>\n          <p class=\"text-right text-primary py-2\">(免運費)信用卡付款</p>\n          <div class=\"clearfix py-2\">\n            <button\n              class=\"btn btn-outline-primary btn-sm float-right rounded-0 btn-custom\"\n              type=\"button\"\n              @click.prevent=\"addCoupon\"\n              style=\"height:28px\"\n            >套用優惠碼</button>\n            <input\n              type=\"text\"\n              class=\"float-right rounded-0\"\n              style=\"height: 28px;\"\n              width=\"40%\"\n              placeholder=\"請輸入優惠碼\"\n              v-model=\"couponCode\"\n            />\n          </div>\n          <div class=\"clearfix\">\n            <p\n              class=\"text-danger float-right clearfix\"\n              style=\"margin-right:132px\"\n              v-if=\"error.length > 1\"\n            >{{ this.error }}</p>\n          </div>\n          <div class=\"clearfix\">\n            <a\n              href=\"#\"\n              class=\"btn btn-primary btn-lg float-right text-white\"\n              style=\"margin-top: 10px\"\n              type=\"button\"\n              @click=\"addCart\"\n            >結帳去</a>\n          </div>\n        </div>\n      </div>\n    </section>\n  </div>\n</template>\n\n<script>\nexport default {\n  data() {\n    return {\n      couponCode: '',\n      isLoading: false,\n      error: '',\n      productNum: 1,\n      total: 0,\n      cart: {},\n      final_total: 0,\n      delCart: {},\n      origin_carts: [],\n    };\n  },\n  methods: {\n    returnShop() {\n      const api = `${process.env.VUE_APP_APIPATH}/api/${process.env.VUE_APP_CUMSTOMPATH}/cart`;\n      this.$http.get(api).then(() => {\n        if (this.cart.carts.length === 1) {\n          this.getCart();\n          this.$bus.$emit('message:push', '購物車內無商品，請選購。');\n          this.$router.push('/product_list');\n        }\n      });\n    },\n    removeCart(id) {\n      const carts = this.origin_carts.filter((item) => item.product_id === id);\n      const vm = this;\n      vm.isLoading = true;\n      const aa = carts.map(async (item) => {\n        const api = `${process.env.VUE_APP_APIPATH}/api/cart/${item.id}`;\n        await vm.$http.delete(api).then(() => { });\n      });\n      Promise.allSettled([...aa]).then(() => {\n        vm.isLoading = false;\n        vm.getCart();\n        vm.returnShop();\n      });\n    },\n    useAllCoupon(carts) {\n      const coupons = carts.filter(((item) => item.coupon));\n      const api = `${process.env.VUE_APP_APIPATH}/api/${process.env.VUE_APP_CUMSTOMPATH}/coupon`;\n      const { code } = coupons[0].coupon;\n      this.$http.post(api, { data: { code } }).then((response) => {\n        if (response.data.success) {\n          this.getCart();\n        }\n      });\n    },\n    addCoupon() {\n      const api = `${process.env.VUE_APP_APIPATH}/api/${process.env.VUE_APP_CUMSTOMPATH}/coupon`;\n      const coupon = {\n        code: this.couponCode,\n      };\n      this.isLoading = true;\n      this.$http.post(api, { data: coupon }).then((response) => {\n        if (response.data.success) {\n          this.getCart();\n          this.isLoading = false;\n          this.error = '';\n        } else {\n          this.isLoading = false;\n          this.error = '請輸入正確的優惠卷';\n        }\n      });\n    },\n    getCart() {\n      const api = `${process.env.VUE_APP_APIPATH}/api/${process.env.VUE_APP_CUMSTOMPATH}/cart`;\n      this.isLoading = true;\n      this.$http.get(api).then((response) => {\n        const coupons = response.data.data.carts?.filter(((item) => item.coupon));\n        if (coupons?.length && coupons.length < response.data?.data?.carts?.length) {\n          this.useAllCoupon(response.data.data.carts);\n        } else {\n          this.origin_carts = [...response.data.data.carts];\n          this.cart = response.data.data;\n          const newCart = JSON.parse(JSON.stringify(this.cart));\n          const cartsMap = new Map();\n          newCart.carts.forEach((item) => {\n            cartsMap.set(item.product.id, item);\n          });\n          cartsMap.forEach((mapItem) => {\n            const MapItem = mapItem;\n            MapItem.qty = 0;\n            MapItem.final_total = 0;\n            MapItem.total = 0;\n          });\n          cartsMap.forEach((mapItem) => {\n            const MapItem = mapItem;\n            this.cart.carts.forEach((item) => {\n              if (item.product_id === MapItem.product_id) {\n                MapItem.qty += item.qty;\n                MapItem.final_total = item.final_total;\n                MapItem.total = item.total;\n              }\n            });\n          });\n          this.cart.carts.splice(0, this.cart.carts.length);\n          cartsMap.forEach((map) => this.cart.carts.push(map));\n          this.isLoading = false;\n        }\n      });\n    },\n    addCart() {\n      const api = `${process.env.VUE_APP_APIPATH}/api/${process.env.VUE_APP_CUMSTOMPATH}/cart`;\n      let delApi = '';\n      let cart = {};\n      const vm = this;\n      (async function IIFE() {\n        await vm.$http.get(api).then((response) => {\n          vm.delCart = response.data.data;\n        });\n        await vm.delCart.carts.forEach(async (item) => {\n          delApi = `${process.env.VUE_APP_APIPATH}/api/${process.env.VUE_APP_CUMSTOMPATH}/cart/${item.id}`;\n          await vm.$http.delete(delApi).then(() => {});\n        });\n        await vm.cart.carts.forEach(async (item) => {\n          cart = {\n            product_id: item.product.id,\n            qty: item.qty,\n          };\n          await vm.$http.post(api, { data: cart }).then(() => { });\n        });\n        if (vm.cart.carts?.length && vm.cart.carts.some((item) => (item?.coupon))) {\n          const couponApi = `${process.env.VUE_APP_APIPATH}/api/${process.env.VUE_APP_CUMSTOMPATH}/coupon`;\n          const code = vm.cart.carts.find((item) => (item?.coupon))?.coupon?.code;\n          await vm.$http.post(couponApi, { data: { code } }).then(() => {});\n        }\n        vm.$router.push('/order');\n      }());\n    },\n    finalTotal() {\n      this.total = 0;\n      this.final_total = 0;\n      this.cart.carts.forEach((item) => {\n        const price = item.product.price ? item.product.price : item.product.origin_price;\n        const coupon = item?.coupon?.percent ?? 100;\n        this.total += item.qty * price;\n        this.final_total += (item.qty * price * coupon) / 100;\n      });\n    },\n  },\n  created() {\n    this.getCart();\n  },\n  beforeUpdate() {\n    this.finalTotal();\n  },\n};\n</script>\n\n<style lang=\"scss\" scoped>\n.wrap {\n  margin-top: 67px;\n}\n.img {\n  background-image: url(https://images.unsplash.com/photo-1437750635120-f98648c0fe03?ixlib=rb-1.2.1&ixid=eyJhcHBfaWQiOjEyMDd9&auto=format&fit=crop&w=1950&q=80);\n  width: 100%;\n  height: 25vw;\n  background-position: center;\n  background-size: cover;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  h2 {\n    color: white;\n    font-weight: bold;\n    font-size: 40px;\n  }\n}\n.cart {\n  padding: 20px;\n  p {\n    margin: 0;\n  }\n  input[type=\"text\"] {\n    border: #01814a 1px solid;\n    border-radius: 4px;\n  }\n  input[type=\"text\"]:focus {\n    outline: #01814a 3px solid;\n    box-shadow: 2px 2px 10px #484891;\n  }\n}\n.btn-custom:focus{\n  box-shadow: none !important;\n  color: #fff !important;\n  background-color: #336666 !important;\n}\n.progress-wrap{\n  padding-left: 74px;\n}\n.progressBar {\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  width: 100%;\n  li {\n    width: 40px;\n    height: 40px;\n    border-radius: 50%;\n    border: 1px solid #333;\n    background-color: white;\n    text-align: center;\n    line-height: 40px;\n    margin-right: 85px;\n    position: relative;\n  }\n  li:not(:last-child)::after {\n    content: \"\";\n    height: 10px;\n    width: 90px;\n    background-color: white;\n    border: solid 1px #333;\n    position: absolute;\n    top: 50%;\n    left: 100%;\n    transform: translateY(-50%);\n  }\n  li:nth-of-type(1),\n  li:nth-of-type(2) {\n    background-color: #02C874;\n  }\n  li:nth-of-type(1)::after {\n    background-color: #02C874;\n  }\n  li:nth-of-type(2)::before {\n    content: \"購物車選購\";\n    position: absolute;\n    top: 100%;\n    left: -22px;\n    text-align: center;\n    width: 80px;\n    color: #333333;\n    font-weight: bold;\n  }\n}\n.progressTitle {\n  margin-right: 45px;\n}\n@media (max-width: 768px) {\n  .progress-wrap{\n  padding-left: 24px;\n  }\n  .progressTitle {\n    margin-right: 30px;\n  }\n  .progressBar {\n    padding-left: 20px;\n    li {\n      margin-right: 50px;\n    }\n    li:not(:last-child)::after {\n      width: 52px;\n    }\n    li:nth-of-type(2)::before {\n      left: -24px;\n      width: 80px;\n    }\n  }\n}\n@media (max-width: 500.98px) {\n  .progress-wrap{\n  padding-left: 10px;\n  }\n  .progressTitle {\n    margin-right: 5px;\n  }\n  .progressBar {\n    padding-left: 20px;\n    width: 100%;\n    li {\n      width: 30px;\n      height: 30px;\n      line-height: 30px;\n      margin-right: 30px;\n    }\n    li:not(:last-child)::after {\n      width: 32px;\n    }\n    li:not(:last-child){\n      padding: 0 4px;\n    }\n    li:first-child{\n      padding: 0 8px;\n    }\n    li:nth-of-type(2)::before {\n      left: -26px;\n      width: 80px;\n    }\n  }\n}\n@media (max-width: 350px) {\n  .progress-wrap{\n  padding-left: 0;\n  }\n  .smallPhoneHide{\n    display: none;\n  }\n}\n</style>\n","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ShoppingCart.vue?vue&type=script&lang=js\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ShoppingCart.vue?vue&type=script&lang=js\"","import { render, staticRenderFns } from \"./ShoppingCart.vue?vue&type=template&id=41fde6e7&scoped=true\"\nimport script from \"./ShoppingCart.vue?vue&type=script&lang=js\"\nexport * from \"./ShoppingCart.vue?vue&type=script&lang=js\"\nimport style0 from \"./ShoppingCart.vue?vue&type=style&index=0&id=41fde6e7&prod&lang=scss&scoped=true\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"41fde6e7\",\n  null\n  \n)\n\nexport default component.exports"],"sourceRoot":""}